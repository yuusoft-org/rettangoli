---
title: "With Waveform"
---
<rtgl-view id="container" g="lg" h="100vh" w="100vw" fw="w">
</rtgl-view>

<script>
  const form = document.createElement('rtgl-form');
  form.id = 'form';
  form.setAttribute('w', '400');

  form.defaultValues = {
    audioName: 'sample_audio.mp3',
    volume: 75
  }

  const waveformData = {"amplitudes":[164,222,88,186,64,231,117,56,138,10,211,31,98,124,147,205,192,197,1,35,155,205,163,230,10,82,80,246,72,246,169,168,167,154,6,32,84,23,79,213,66,63,33,29,74,66,221,122,244,236,147,241,118,12,120,100,42,108,117,235,10,95,153,190,90,158,107,139,4,128,66,35,101,88,214,178,139,197,214,219,226,229,86,48,177,247,229,253,140,36,152,76,96,101,247,73,90,160,27,177,115,226,95,179,36,75,252,86,99,33,199,147,45,150,123,205,2,191,121,93,141,79,176,2,6,12,206,59,179,162,136,230,41,19,201,135,245,58,115,94,129,124,173,111,123,210,68,1,1,233,67,17,84,210,123,172,118,29,8,82,95,199,72,34,43,95,111,47,216,87,70,173,241,253,151,72,36,243,32,231,129,239,59,45,110,167,151,8,246,238,50,11,91,87,120,118,173,37,147,226,161,167,213,163,209,89,229,207,173,202,67,218,115,81,61,38,33,168,65,214,102,194,176,210,253,209,47,159,14,48,110,81,101,226,23,140,224,43,215,159,84,171,244,226,78,133,140,135,200,199,19,136,78,213,144,47,49,107,10,181,85,165,206,212,129,142,42,16,61,144,255,159,126,171,138,41,184,173,72,228,130,45,97,197,188,87,4,247,141,73,46,8,97,94,70,156,94,41,100,45,81,31,166,210,43,20,154,91,26,56,249,158,40,170,208,116,125,125,12,155,226,247,239,56,178,253,105,181,165,234,115,37,237,190,121,22,241,252,93,202,6,156,115,58,5,19,196,81,248,185,23,166,47,144,251,5,195,247,220,12,185,1,229,173,131,223,80,212,79,130,13,32,53,9,140,31,96,226,119,134,40,137,64,37,3,146,235,251,154,126,147,82,64,106,188,62,36,57,226,68,138,11,119,190,198,127,106,48,240,250,246,255,243,104,94,67,10,45,104,52,181,91,119,86,188,146,99,236,11,128,140,126,107,246,125,168,63,94,131,80,90,56,171,168,70,228,0,98,7,167,132,241,243,124,104,10,163,156,140,102,18,73,219,5,165,126,13,132,201,227,147,151,91,105,22,238,100,130,49,165,135,170,249,57,6,236,124,25,177,50,97,138,15,63,200,134,34,188,124,194,252,178,130,4,167,229,28,228,214,39,37,59,48,76,147,141,101,217,155,2,32,191,231,158,218,50,197,147,17,19,63,244,93,204,198,215,12,56,249,88,193,239,168,206,233,203,40,121,49,66,148,60,113,2,6,247,236,105,63,177,96,179,207,129,117,123,111,95,137,188,46,172,165,236,234,189,96,120,47,146,135,199,248,38,164,152,226,180,171,34,121,84,235,28,155,108,49,133,104,206,85,173,250,105,52,149,30,92,102,143,58,147,148,86,130,20,193,205,120,86,49,171,54,214,143,81,124,108,94,150,166,253,57,53,145,129,11,7,228,171,102,176,231,107,139,138,123,165,0,191,236,254,177,94,114,160,121,164,108,36,165,69,199,64,43,224,253,85,4,204,126,31,50,117,63,99,7,101,248,14,108,98,133,18,106,95,133,143,156,28,65,211,144,0,112,221,210,236,6,151,142,241,194,174,61,113,5,86,123,118,48,75,64,18,47,4,218,13,146,217,56,39,189,220,169,221,35,185,220,147,176,177,188,162,17,202,72,29,128,131,164,45,223,188,196,31,176,244,124,162,254,100,190,233,81,60,83,181,240,105,208,28,150,155,55,177,122,139,23,187,187,111,228,121,214,251,156,67,114,203,232,24,151,138,112,111,99,228,174,233,137,94,87,119,94,37,170,51,116,102,83,13,9,63,34,11,247,150,235,97,126,146,34,199,97,0,71,67,9,147,81,127,5,229,90,244,80,164,144,107,53,26,224,180,165,228,134,35,75,175,163,145,78,164,152,176,206,247,186,171,86,175,67,177,117,241,191,149,132,232,165,185,192,152,108,98,245,6,107,121,241,48,151,193,160,73,197,143,70,129,78,148,94,29,127,105,169,152,56,199,211,52,201,231,161,5,149,23,57,117,84,77,59,231,39,88,148,213,156,218,173,174,147,121,188,30,254,129,82,214,194,66,56,34,252,139,183,29,158,62,36,22,109,84,2,105,32,149,140,208,6,4,238,58,87,41,55,49,186,219,91,116,128,148,243,65,170,49,244,158,171,31,132,48,164,172,249,126,159,81,175,119,119,143,204,69,38,186,241,214,212,143,218,176,27,24,200,255,202,144,38,76,6,144,199,0,83,97,125,124],"duration":341.3281179138322,"sampleRate":44100,"channels":2}

  form.form = {
    title: 'Audio Settings',
    description: 'Configure your audio waveform visualization',
    fields: [{
      name: 'audioWaveform',
      inputType: 'waveform',
      label: 'Audio Waveform',
      description: 'Click to change the audio file',
      width: 300,
      height: 120,
      waveformData
    }, {
      name: 'voiceWaveform',
      inputType: 'waveform',
      label: 'Voice Recording',
      description: 'Click to record or upload voice',
      width: 250,
      height: 100,
      waveformData
    }, {
      name: 'placeholderWaveform',
      inputType: 'waveform',
      label: 'Empty Waveform',
      description: 'This shows placeholder when no waveform is available',
      width: 300,
      height: 120,
      placeholder: 'Click to load audio'
    }, {
      name: 'audioName',
      inputType: 'inputText',
      label: 'Audio File Name',
      placeholder: 'Enter audio file name'
    }, {
      name: 'volume',
      inputType: 'slider',
      label: 'Volume',
      min: 0,
      max: 100,
      step: 1
    }],
    actions: {
      buttons: [{
        id: 'save',
        variant: 'pr',
        content: 'Save Settings',
      }, {
        id: 'cancel',
        variant: 'se',
        content: 'Cancel',
      }],
    }
  }

  form.addEventListener('action-click', (e) => {
    console.log('action-click', e.detail);

    // Update waveform data when save is clicked
    if (e.detail.actionId === 'save') {
      // Update waveform data directly on fields
      const audioField = form.form.fields.find(f => f.name === 'audioWaveform');
      const voiceField = form.form.fields.find(f => f.name === 'voiceWaveform');

      if (audioField) {
        audioField.waveformData = waveformData;
      }
      if (voiceField) {
        voiceField.waveformData = waveformData;
      }

      form.render();

      console.log('Updated fields with new waveform data');
    }
  });

  form.addEventListener('form-change', (e) => {
    console.log('form-change', e.detail);
  });

  form.addEventListener('extra-event', (e) => {
    console.log('extra-event (waveform clicked)', e.detail);
    alert(`Waveform ${e.detail.trigger}: ${e.detail.name} at (${e.detail.x}, ${e.detail.y})`);
  });

  document.getElementById('container').appendChild(form);
</script>
