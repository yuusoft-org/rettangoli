elementName: rtgl-select

viewDataSchema:
  type: object

attrsSchema:
  type: object
  properties:
    placeholder:
      type: string

propsSchema:
  type: object
  properties:
    placeholder:
      type: string
    options:
      type: array
      items:
        type: object
        properties:
          label:
            type: string
          value:
            type: any
          testId:
            type: string
    selectedValue:
      type: any
    onChange:
      type: function
    noClear:
      type: boolean
    addOption:
      type: object
      properties:
        label:
          type: string

refs:
  select-button:
    eventListeners:
      click:
        handler: handleButtonClick
  clear-button:
    eventListeners:
      click:
        handler: handleClearClick
  popover:
    eventListeners:
      close:
        handler: handleClickOptionsPopoverOverlay
  option-*:
    eventListeners:
      click:
        handler: handleOptionClick
      mouseenter:
        handler: handleOptionMouseEnter
      mouseleave:
        handler: handleOptionMouseLeave
  option-add:
    eventListeners:
      click:
        handler: handleAddOptionClick
      mouseenter:
        handler: handleAddOptionMouseEnter
      mouseleave:
        handler: handleAddOptionMouseLeave

events:
  value-change: {}
  add-option-click: {}

template:
  - rtgl-button#select-button v=ol ${containerAttrString} data-testid="select-button":
      - rtgl-view d=h av=c w=f:
          - rtgl-text c=${selectedLabelColor} ellipsis: ${selectedLabel}
          - rtgl-view mh=md flex=1:
          - $if showClear:
              - rtgl-svg#clear-button mr=md svg=x wh=16 c=mu-fg cur=p data-testid="select-clear-button":
          - rtgl-svg svg=chevronDown wh=16 c=mu-fg:
  - rtgl-popover#popover ?open=${isOpen} x=${position.x} y=${position.y} placement=right-start:
      - rtgl-view wh=300 g=xs slot=content bgc=bg br=md sv=true:
          - $for option, i in options:
              - rtgl-view#option-${i} w=f ph=lg pv=md cur=p br=md bgc=${option.bgc} data-testid=${option.testId}:
                  - rtgl-text: ${option.label}
          - $if showAddOption:
              - rtgl-view w=f bw=xs bc=mu bwt=sm:
              - rtgl-view#option-add w=f ph=lg pv=md cur=p br=md bgc=${addOptionBgc} data-testid="select-add-option":
                  - rtgl-text c=ac: ${addOptionLabel}
