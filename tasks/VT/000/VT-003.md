### Refactoring the Visual Test Step Runner

Right now everything for running visual test steps lives inside one big `switch` block in `takeScreenshots`. As soon as we add more steps like `click`, `wait`, `goto`, maybe scroll or type later that function will keep getting bigger. It becomes harder to read and if left like that it could break something later.


A cleaner approach is to move toward a small step registry. Every step lives in its own tiny module, and the runner just looks up the right handler and executes it. This avoids touching the core logic every time we add one more behavior.

Below is how that looks in practice.

---

### 1. Each step becomes its own file.

```javascript
// packages/rettangoli-vt/src/cli/vt-steps/goto.js
export default async (page, args) => {
  await page.goto(args[0], { waitUntil: "networkidle" });
};
```

### 2. A registry maps steps names to their handlers.

```javascript
// packages/rettangoli-vt/src/cli/vt-steps/index.js
import goto from './goto.js';
import click from './click.js';
// ...more steps

export const steps = {
  goto,
  click,
  // ...
};
```
### 3. A small factory executes a given step

```javascript
// packages/rettangoli-vt/src/cli/createSteps.js
import { steps } from './vt-steps/index.js';

export function createSteps(page, context) {
  return {
    async executeStep(stepString) {
      const [step, ...args] = stepString.split(" ");
      if (steps[step]) {
        await steps[step](page, args, context);
      }
    }
  };
}
```

### 4. The final flow

```javascript
// packages/rettangoli-vt/src/common.js (inside takeScreenshots)

const steps = createSteps(page, stepContext);

for (const step of file.frontMatter?.steps || []) {
  await steps.executeStep(step);
}
```

### Drawbacks

The main trade-off with this approach is an increase in the number of files. A simple one line step like wait will now live in its own file, which might seem like overkill initially.

### Why we should still implement it

- Take screenshot isnt responsible for doing the step, it just passes the steps without knowing anything of how to handle the steps
- If we decide to swtich to test mode (meaning on test environment rather than the browser launch) and if we have many steps we can easily divide the work to make the migration faster